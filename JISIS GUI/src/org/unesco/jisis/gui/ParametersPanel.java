/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

package org.unesco.jisis.gui;

import java.io.File;
import javax.swing.JFileChooser;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import org.openide.util.NbPreferences;

public final class ParametersPanel extends javax.swing.JPanel implements DocumentListener, ChangeListener {

    private final ParametersOptionsPanelController controller;
    private JFileChooser fileChooser;
    

    ParametersPanel(ParametersOptionsPanelController controller) {
        this.controller = controller;
        initComponents();
        fileChooser = new JFileChooser();
        // TODO listen to changes in form fields and call controller.changed()
        txtMozillaPath.getDocument().addDocumentListener(this);
        txtDefaultConnection.getDocument().addDocumentListener(this);
        txtDefaultDbHome.getDocument().addDocumentListener(this);
        txtDefaultDb.getDocument().addDocumentListener(this);

        chkbUseDefaultParameters.addChangeListener(this);



    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
   // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
   private void initComponents() {

      lblMozilla = new javax.swing.JLabel();
      txtMozillaPath = new javax.swing.JTextField();
      btnChooseMozilla = new javax.swing.JButton();
      lblDefaultConnection = new javax.swing.JLabel();
      jSeparator1 = new javax.swing.JSeparator();
      chkbUseDefaultParameters = new javax.swing.JCheckBox();
      txtDefaultConnection = new javax.swing.JTextField();
      lblDefaultDbHome = new javax.swing.JLabel();
      lblDefaultDb = new javax.swing.JLabel();
      txtDefaultDbHome = new javax.swing.JTextField();
      txtDefaultDb = new javax.swing.JTextField();
      lblDefaultLanguage = new javax.swing.JLabel();
      cbLanguage = new javax.swing.JComboBox();
      lblOccurrenceSeparator = new javax.swing.JLabel();
      cbOccurrenceSeparator = new javax.swing.JComboBox();
      lblIndexingWordLength = new javax.swing.JLabel();
      txtIndexingWordLength = new javax.swing.JTextField();
      jLabel1 = new javax.swing.JLabel();
      txtFont = new javax.swing.JTextField();
      btnChangeFont = new javax.swing.JButton();

      lblMozilla.setFont(new java.awt.Font("Tahoma", 1, 11));
      org.openide.awt.Mnemonics.setLocalizedText(lblMozilla, org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.lblMozilla.text")); // NOI18N

      txtMozillaPath.setText(org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.txtMozillaPath.text")); // NOI18N

      org.openide.awt.Mnemonics.setLocalizedText(btnChooseMozilla, org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.btnChooseMozilla.text")); // NOI18N
      btnChooseMozilla.addActionListener(new java.awt.event.ActionListener() {
         public void actionPerformed(java.awt.event.ActionEvent evt) {
            btnChooseMozillaActionPerformed(evt);
         }
      });

      org.openide.awt.Mnemonics.setLocalizedText(lblDefaultConnection, org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.lblDefaultConnection.text")); // NOI18N

      chkbUseDefaultParameters.setFont(new java.awt.Font("Tahoma", 1, 11));
      org.openide.awt.Mnemonics.setLocalizedText(chkbUseDefaultParameters, org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.chkbUseDefaultParameters.text")); // NOI18N

      txtDefaultConnection.setText(org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.txtDefaultConnection.text")); // NOI18N

      org.openide.awt.Mnemonics.setLocalizedText(lblDefaultDbHome, org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.lblDefaultDbHome.text")); // NOI18N

      org.openide.awt.Mnemonics.setLocalizedText(lblDefaultDb, org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.lblDefaultDb.text")); // NOI18N

      txtDefaultDbHome.setText(org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.txtDefaultDbHome.text")); // NOI18N
      txtDefaultDbHome.addActionListener(new java.awt.event.ActionListener() {
         public void actionPerformed(java.awt.event.ActionEvent evt) {
            txtDefaultDbHomeActionPerformed(evt);
         }
      });

      txtDefaultDb.setText(org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.txtDefaultDb.text")); // NOI18N

      org.openide.awt.Mnemonics.setLocalizedText(lblDefaultLanguage, org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.lblDefaultLanguage.text")); // NOI18N

      cbLanguage.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "English", " " }));

      org.openide.awt.Mnemonics.setLocalizedText(lblOccurrenceSeparator, org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.lblOccurrenceSeparator.text")); // NOI18N

      cbOccurrenceSeparator.setEditable(true);
      cbOccurrenceSeparator.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "%", "ยง", "#", "@", " " }));

      org.openide.awt.Mnemonics.setLocalizedText(lblIndexingWordLength, org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.lblIndexingWordLength.text")); // NOI18N

      txtIndexingWordLength.setText(org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.txtIndexingWordLength.text")); // NOI18N

      org.openide.awt.Mnemonics.setLocalizedText(jLabel1, org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.jLabel1.text")); // NOI18N

      txtFont.setText(org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.txtFont.text")); // NOI18N

      org.openide.awt.Mnemonics.setLocalizedText(btnChangeFont, org.openide.util.NbBundle.getMessage(ParametersPanel.class, "ParametersPanel.btnChangeFont.text")); // NOI18N

      javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
      this.setLayout(layout);
      layout.setHorizontalGroup(
         layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
         .addGroup(layout.createSequentialGroup()
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
               .addGroup(layout.createSequentialGroup()
                  .addContainerGap()
                  .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                     .addGroup(layout.createSequentialGroup()
                        .addGap(23, 23, 23)
                        .addComponent(chkbUseDefaultParameters)
                        .addGap(71, 71, 71))
                     .addGroup(layout.createSequentialGroup()
                        .addComponent(lblMozilla)
                        .addGap(18, 18, 18)
                        .addComponent(txtMozillaPath, javax.swing.GroupLayout.PREFERRED_SIZE, 270, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnChooseMozilla))
                     .addComponent(jSeparator1, javax.swing.GroupLayout.DEFAULT_SIZE, 641, Short.MAX_VALUE)))
               .addGroup(layout.createSequentialGroup()
                  .addGap(25, 25, 25)
                  .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                     .addComponent(lblDefaultConnection, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE)
                     .addComponent(lblDefaultDbHome, javax.swing.GroupLayout.Alignment.TRAILING)
                     .addComponent(lblDefaultDb, javax.swing.GroupLayout.Alignment.TRAILING)
                     .addComponent(lblDefaultLanguage, javax.swing.GroupLayout.Alignment.TRAILING)
                     .addComponent(lblOccurrenceSeparator, javax.swing.GroupLayout.Alignment.TRAILING)
                     .addComponent(lblIndexingWordLength, javax.swing.GroupLayout.Alignment.TRAILING)
                     .addComponent(jLabel1, javax.swing.GroupLayout.Alignment.TRAILING))
                  .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                  .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                     .addComponent(cbOccurrenceSeparator, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                     .addComponent(cbLanguage, javax.swing.GroupLayout.PREFERRED_SIZE, 151, javax.swing.GroupLayout.PREFERRED_SIZE)
                     .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                        .addComponent(txtDefaultConnection, javax.swing.GroupLayout.DEFAULT_SIZE, 276, Short.MAX_VALUE)
                        .addComponent(txtDefaultDbHome)
                        .addComponent(txtDefaultDb, javax.swing.GroupLayout.PREFERRED_SIZE, 235, javax.swing.GroupLayout.PREFERRED_SIZE))
                     .addComponent(txtIndexingWordLength, javax.swing.GroupLayout.PREFERRED_SIZE, 72, javax.swing.GroupLayout.PREFERRED_SIZE)
                     .addGroup(layout.createSequentialGroup()
                        .addComponent(txtFont, javax.swing.GroupLayout.PREFERRED_SIZE, 196, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnChangeFont)))))
            .addContainerGap())
      );
      layout.setVerticalGroup(
         layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
         .addGroup(layout.createSequentialGroup()
            .addContainerGap()
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
               .addComponent(lblMozilla, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
               .addComponent(txtMozillaPath, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
               .addComponent(btnChooseMozilla))
            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
            .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
            .addComponent(chkbUseDefaultParameters)
            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 27, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
               .addComponent(jLabel1)
               .addComponent(txtFont, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
               .addComponent(btnChangeFont))
            .addGap(32, 32, 32)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
               .addComponent(lblDefaultConnection)
               .addComponent(txtDefaultConnection, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
               .addComponent(lblDefaultDbHome)
               .addComponent(txtDefaultDbHome, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addGap(18, 18, 18)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
               .addComponent(lblDefaultDb)
               .addComponent(txtDefaultDb, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addGap(18, 18, 18)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
               .addComponent(lblDefaultLanguage)
               .addComponent(cbLanguage, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addGap(21, 21, 21)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
               .addComponent(lblOccurrenceSeparator)
               .addComponent(cbOccurrenceSeparator, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addGap(18, 18, 18)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
               .addComponent(txtIndexingWordLength, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
               .addComponent(lblIndexingWordLength, javax.swing.GroupLayout.PREFERRED_SIZE, 14, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addGap(63, 63, 63))
      );
   }// </editor-fold>//GEN-END:initComponents

    private void btnChooseMozillaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnChooseMozillaActionPerformed
        // TODO add your handling code here:
        fileChooser.setCurrentDirectory(new File("."));
        int result = fileChooser.showOpenDialog(this);
        if (result == JFileChooser.APPROVE_OPTION){
            txtMozillaPath.setText(fileChooser.getSelectedFile().getAbsolutePath());

        }
    }//GEN-LAST:event_btnChooseMozillaActionPerformed

    private void txtDefaultDbHomeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtDefaultDbHomeActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtDefaultDbHomeActionPerformed

    void load() {
        // TODO read settings and initialize GUI
        // Example:        
        // someCheckBox.setSelected(Preferences.userNodeForPackage(ParametersPanel.class).getBoolean("someFlag", false));
        // or for org.openide.util with API spec. version >= 7.4:
        // someCheckBox.setSelected(NbPreferences.forModule(ParametersPanel.class).getBoolean("someFlag", false));
        // or:
        // someTextField.setText(SomeSystemOption.getDefault().getSomeStringProperty());
         txtMozillaPath.setText(
            NbPreferences.forModule(ParametersPanel.class).get("txtMozillaPath",
            "Mozilla_Executable_Path_Default"));
        txtDefaultConnection.setText(
            NbPreferences.forModule(ParametersPanel.class).get("txtDefaultConnection",
            "Connection_Default"));
        txtDefaultDbHome.setText(
                NbPreferences.forModule(ParametersPanel.class).get("txtDefaultDbHome",
                "DbHome_Default"));
        txtDefaultDb.setText(
                NbPreferences.forModule(ParametersPanel.class).get("txtDefaultDb",
                "Database_Default"));


        chkbUseDefaultParameters.setSelected(
                NbPreferences.forModule(ParametersPanel.class).getBoolean("chkbUseDefaultParameters",false));

        cbOccurrenceSeparator.setSelectedItem(
         NbPreferences.forModule(ParametersPanel.class).get("occurrenceSeparator","%"));

        cbLanguage.setSelectedItem(
         NbPreferences.forModule(ParametersPanel.class).get("defaultLanguage","English"));

        txtIndexingWordLength.setText(
                NbPreferences.forModule(ParametersPanel.class).get("txtIndexingWordLength",
                "Index_Word_Length"));

    }

    void store() {
        // TODO store modified settings
        // Example:
        // Preferences.userNodeForPackage(ParametersPanel.class).putBoolean("someFlag", someCheckBox.isSelected());
        // or for org.openide.util with API spec. version >= 7.4:
        // NbPreferences.forModule(ParametersPanel.class).putBoolean("someFlag", someCheckBox.isSelected());
        // or:
        // SomeSystemOption.getDefault().setSomeStringProperty(someTextField.getText());
        NbPreferences.forModule(ParametersPanel.class).
            put("txtMozillaPath",txtMozillaPath.getText());

        NbPreferences.forModule(ParametersPanel.class).
            put("txtDefaultConnection",txtDefaultConnection.getText());

        NbPreferences.forModule(ParametersPanel.class).
            put("txtDefaultDbHome",txtDefaultDbHome.getText());

        NbPreferences.forModule(ParametersPanel.class).
                put("txtDefaultDb",txtDefaultDb.getText());

         NbPreferences.forModule(ParametersPanel.class).
                putBoolean("chkbUseDefaultParameters",chkbUseDefaultParameters.isSelected());


         NbPreferences.forModule(ParametersPanel.class).
                 put("occurrenceSeparator",(String) cbOccurrenceSeparator.getSelectedItem());

         
         NbPreferences.forModule(ParametersPanel.class).
                 put("defaultLanguage",(String) cbLanguage.getSelectedItem());


                NbPreferences.forModule(ParametersPanel.class).put("txtIndexingWordLength",
                txtIndexingWordLength.getText());
    }

    boolean valid() {
        // TODO check whether form is consistent and complete
        if (!txtMozillaPath.getText().toLowerCase().endsWith("mozilla.exe")) {
            return false;
        }
        return true;
    }

   // Variables declaration - do not modify//GEN-BEGIN:variables
   private javax.swing.JButton btnChangeFont;
   private javax.swing.JButton btnChooseMozilla;
   private javax.swing.JComboBox cbLanguage;
   private javax.swing.JComboBox cbOccurrenceSeparator;
   private javax.swing.JCheckBox chkbUseDefaultParameters;
   private javax.swing.JLabel jLabel1;
   private javax.swing.JSeparator jSeparator1;
   private javax.swing.JLabel lblDefaultConnection;
   private javax.swing.JLabel lblDefaultDb;
   private javax.swing.JLabel lblDefaultDbHome;
   private javax.swing.JLabel lblDefaultLanguage;
   private javax.swing.JLabel lblIndexingWordLength;
   private javax.swing.JLabel lblMozilla;
   private javax.swing.JLabel lblOccurrenceSeparator;
   private javax.swing.JTextField txtDefaultConnection;
   private javax.swing.JTextField txtDefaultDb;
   private javax.swing.JTextField txtDefaultDbHome;
   private javax.swing.JTextField txtFont;
   private javax.swing.JTextField txtIndexingWordLength;
   private javax.swing.JTextField txtMozillaPath;
   // End of variables declaration//GEN-END:variables

    public void insertUpdate(DocumentEvent arg0) {
        controller.changed();
    }

    public void removeUpdate(DocumentEvent arg0) {
        controller.changed();
    }

    public void changedUpdate(DocumentEvent arg0) {
        controller.changed();
    }

    public void stateChanged(ChangeEvent evt) {
        controller.changed();

    }
}
